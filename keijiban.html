<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ツエーゲン金沢掲示板</title>
    <style>
        /* ここにスタイルを追加する */
        section {
            margin-top: 20px;
        }

        .post {
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
        }

        .post span.name {
            font-weight: bold;
            color: #007bff; /* 任意の色を指定 */
        }

        .deleteButton {
            margin-top: 10px;
        }

        #timeRemaining {
            color: red; /* 残り時間を目立たせるための色 */
        }
    </style>
</head>
<body>
    <h1>ツエーゲン金沢掲示板</h1>
    <section>
        <h2>新規投稿</h2>
        <form id="postForm">
            名前：<input type="text" name="name" id="name"><br>
            本文：<textarea name="section" id="content" rows="3"></textarea><br>
            <button type="button" onclick="addPost()" id="postButton">投稿する</button>
            <span id="timeRemaining"></span>
        </form>
    </section>
    <section>
        <h2>投稿一覧</h2>
        <div id="postList"></div>
    </section>

    <script>
        var postButton = document.getElementById("postButton");
        var timeRemainingSpan = document.getElementById("timeRemaining");
        var isButtonEnabled = true;
        var remainingTime = 0;
        var postCount = 0; // Add post count variable

        function enablePostButton() {
            isButtonEnabled = true;
            postButton.removeAttribute("disabled");
            timeRemainingSpan.innerText = "";
        }

        function disablePostButton() {
            isButtonEnabled = false;
            postButton.setAttribute("disabled", "disabled");
            remainingTime = 5;
            updateRemainingTime();
            var interval = setInterval(function () {
                remainingTime -= 1;
                updateRemainingTime();
                if (remainingTime <= 0) {
                    clearInterval(interval);
                    enablePostButton();
                }
            }, 1000);
        }

        function updateRemainingTime() {
            timeRemainingSpan.innerText = "次の投稿まで: " + remainingTime + "秒";
        }

        // 禁止ワードのリスト
        var forbiddenWords = ["禁止ワード1", "禁止ワード2", "禁止ワード3"];

        function containsForbiddenWord(text) {
            for (var i = 0; i < forbiddenWords.length; i++) {
                if (text.includes(forbiddenWords[i])) {
                    return true;
                }
            }
            return false;
        }

        function addPost() {
            if (!isButtonEnabled) {
                alert("5秒間隔でしか投稿できません");
                return;
            }

            // フォームから入力値を取得
            var name = document.getElementById("name").value;
            var content = document.getElementById("content").value;

            // 入力がない場合は何もしない
            if (!name || !content) {
                alert("名前と本文を入力してください");
                return;
            }

            // 禁止ワードが含まれているかチェック
            if (containsForbiddenWord(name) || containsForbiddenWord(content)) {
                alert("禁止ワードが含まれています");
                return;
            }

            // 投稿を表示する要素を取得
            var postList = document.getElementById("postList");

            // 新しい投稿要素を作成
            var postElement = document.createElement("div");
            postElement.classList.add("post");

            // 名前を表示するための span 要素を作成
            var nameSpan = document.createElement("span");
            nameSpan.classList.add("name");
            nameSpan.innerText = name;

            // Get the current date and time
            var currentDate = new Date();
            var formattedDate = currentDate.getFullYear() + '/' + (currentDate.getMonth() + 1) + '/' + currentDate.getDate();
            var formattedTime = currentDate.getHours() + ':' + currentDate.getMinutes();

            // Increment post count
            postCount++;

            // 投稿要素に名前と本文、日時、番号を追加
            postElement.innerHTML = "<span style='font-weight: bold;'>投稿番号: " + postCount + "</span><br>";
            postElement.appendChild(nameSpan);
            postElement.innerHTML += "<br>" + content + "<br>" + formattedDate + " " + formattedTime;

            // Add delete button
            var deleteButton = document.createElement("button");
            deleteButton.classList.add("deleteButton");
            deleteButton.innerText = "削除";
            deleteButton.onclick = function () {
                if (window.confirm("本当に削除しますか？")) {
                    postList.removeChild(postElement);
                }
            };
            postElement.appendChild(deleteButton);

            // 投稿一覧に追加
            postList.appendChild(postElement);

            // フォームをクリア
            document.getElementById("postForm").reset();

            // ボタンを無効にする
            disablePostButton();
        }
    </script>
</body>
</html>
